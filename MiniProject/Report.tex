\documentclass[11pt]{article}
\usepackage{graphicx}
\usepackage{float}
\usepackage[left=3cm,right=3cm]{geometry}
\usepackage[font=scriptsize]{caption}
\usepackage{amsmath}
\usepackage{array}
\usepackage{multirow}
\usepackage{authblk}
\usepackage{lineno}
\usepackage{cite}
%\graphicspath{{../code/}}


\title{The Cubic Polynomial Regression Outperforms Gompertz Equation in Model Fitting of Bacterial Populations}

\author{Cherie Yu}

\affil{Imperial College London}

\date{3 December 2021}

\begin{document}
\maketitle

\pagebreak
\begin{abstract}
    Population growth rates are often used as a response variable to observe and predict changes to 
    population density and abundance. Mathematical models are applied in food microbiology to 
    determine the growth of bacterial populations for the basis of food safety. This study aims 
    to compare how well phenomenological and mechanistic theory models fit to population growth data 
    of bacterial species. By sampling starting parameters from a normal distribution, the polynomial 
    cubic, quadratic and Gompertz equation was successfully fitted to 255 of the 284 unique ID datasets. 
    The Akaike Information Criterion (AIC) was calculated for model comparison. Across all the datasets, 
    the phenomenological cubic equation had the highest total of best fitted growth curves, while 
    the Gompertz model ranked second. This study shows that the mechanistic model has underperformed 
    for unevenly distributed bacterial growth data with small sample sizes and species that demonstrated 
    a death phase. We conclude that model fitting is dependent on the quality of the 
    experimental data. We suggest that model fitting in microbiology should also consider 
    phenomenological models in an area that is rather heavily dependent on mechanistic theories. 
\end{abstract}

\section{Introduction}\\ 

\linenumbers
Population growth rates are used to observe trends in population density and abundance, from 
whether these variables are changing, to the rate they occur \cite{sibly_population_2002}. In addition, population 
growth rates are often applied to predict future projections on population sizes \cite{sibly_population_2002}. Population 
growth rates is important to the application of scientific topics ranging from population ecology, 
conservation biology, food microbiology, evolutionary biology and more \cite{sibly_population_2002,sibly_population_2002-1}. For example, 
population growth rate can be used as a response variable to analysis the success of the invasion 
of maladaptive traits into a resident population \cite{sibly_population_2002-1}.Especially in response to current changing 
conditions that may alter population dynamics e.g climate change, we need to be able to identify 
drivers to the process of population growth, thus helping to prioritize and target management actions \cite{eacker_assessing_2017}. 
In microbiology, modelling bacteria populations have formed the basis of food safety. Being able 
to effectively give realistic predictions of microbial growth during food storage over a range of 
environmental conditions have allowed the minimizing of ineffective, expensive and slow laboratory 
challenge testing of foods \cite{soboleva_predictive_2000,baranyi_mathematics_1995,perni_estimating_2005}. 

Measuring bacteria growth is a measure of all cellular processes and captures how the cells adapts and 
survive in their environmental niches \cite{tonner_bayesian_2020}. Bacterial growth in batch culture often assumes a sigmoid growth 
function with three growth phases captured by three parameters: lag phase is where no growth occurs in which 
bacteria undergoes physiological and regulatory processes that is needed for optimal growth, exponential
phase is where there is accelerating rapid growth in a certain period of time (lag time, also denoted as $\lambda$),
thus reaching a maximal value ($\mu m$) \cite{rolfe_lag_2012}. The final phase is the stationary phase where the carrying capacity ($A$) is reached, 
growth rates decreases and reaches 0 where nutrients has been exhausted \cite{tonner_detecting_2017,zwietering_modeling_1990}.  


    % \begin{figure}[H]
    % \centering
    % \begin{minipage}{.5\textwidth}
    %     \includegraphics[width=.7\linewidth]{example_data_logistic.pdf}
    %     \centering
    %     \caption{This graph demonstrates the annual temperatures from Key West in Florida, USA for the 20th century}
    %     \label{fig:mesh1}
    % \end{minipage}
    % \end{figure}

Previous work has proposed a variety of mathematical models in the form of algebraic curves to describe 
microbial growth, expressed by functions and equations \cite{soboleva_predictive_2000,peleg_microbial_2011}.In this study, I have split such 
models into two distinct forms: phenomenological models and mechanistic theory models. Phenomenological 
models uses a mathematical function that is fitted to the data to describe the underlying biological process \cite{white_should_2019}.
In contrast, mechanistic models include hypothesis-based parameters that have a biological interpretation 
and explicitly tracks the process of a biological system \cite{geritz_mathematical_2012}. The aim of this study is to compare how well 
these two different types of mathematical models fit to population growth data across bacterial species. A 
large part of the literature has been involved in analysing the power between different mechanistic theories 
in modelling bacterial growth, while phenomenological models are often absent in such context \cite{gibson_predicting_1988,adair_comparison_1989,labuza_growth_1993,mackey_effect_1988}.Although
phenomenological models have substantial predictive power, it can also risk not being validated for any
biological systems due to the generality of their parameters, especially if a prediction is outside the known 
parameters \cite{heitzer_utility_1991,schiraldi_phenomenological_nodate,geritz_mathematical_2012}. In mathematical models, the less number of parameters there are, the greater the explanatory
power. The more meaningful and intuitive the parameters of a model are, the more phases of microbial growth
is covered, providing highly accurate models \cite{esser_modeling_2015}. For such reasons, it can be hypothesized that mechanistic
models can be a better fit within bacterial populations that demonstrate a predictive growth 
curve. The objectives of this study were to (1) fit a quadratic and cubic model to the species datasets (2) 
fit a mechanistic Gompertz model (3) compare the models using the calculated Akaike Information Criteria 
(AIC). 

\section{Materials \& Methods}

\noindent\textbf{Theory} \\

Two phenomenological models were used in this study: cubic and quadratic equation. The cubic equation were
fitted using a third degree polynomial regression model and the quadratic equation uses a second order
polynomial form (parabolic curve). \\

The cubic equation is: \\
    \begin{equation}
    y = at^3 + bt^2 + ct + d 
    \end{equation}

The quadratic equation is: \\
    \begin{equation}
    y = bt^2 + ct + d 
    \end{equation}

\noindent where $y$ = population abundance at $t$, $t$ = time and $a$ $b$ $c$ $d$ are regression coefficients. The number of free 
parameters are 4 and 3 respectively. \\

The Gompertz model is one of the most frequently used non-linear sigmoid model fitted to growth curves \cite{gompertz_xxiv_1825}. 
Originally used to describe human mortality rates, it has now been re-parametrized to be applicable within 
modelling bacteria growth, becoming one of the most common mechanistic models to be used by microbiologists \cite{tjorve_use_2017,gibson_predicting_1988}.
(17)(A) \\

Provided by the literature, the modified Gompertz equation is represented by the general equation: \\
    \begin{equation}    
    log(N_{t}) = N_{0} + (N_{max} - N_{0})e^{-e}^{r_{max}exp(1)\frac{t_{lag}-t}{(N_{max} - N_{0})log(10)}+1}
    \end{equation}
   
\noindent where $N_{t}$ is the population size at time $t$, $N_{0}$ is the initial population size during the lag phase,
$N_{max}$ is the largest population size when the carrying capacity is reached, $r_{max}$ is the rate of exponential growth,
$t_{lag}$ is the $x$ intercept (time) to the tangent of the slope of the exponential growth. \\ 

\noindent\textbf{Data} \\

The dataset contains measurements of change in biomass or number of cells of microbes over time(hours). Data was collected 
through lab experiments across the world, citied from nine research papers \cite{bae_growth_2014,bernhardt_metabolic_2018,roth_wheaton_1962,galarz_predicting_2016,gill_growth_1991,silva_modelling_2018,sivonen_effects_1990,stannard_temperaturegrowth_1985,zwietering_modeling_1994}.
Single population growth rate curves are identified by unique temperature-species-medium-citation-replicate combination IDs. A total of 284 
unique IDs was isolated, identified as ID 0 to 284. Using Python 3.9, I eliminated any negative time and population 
data and $NaN$ values due to not making any meaningful biological sense.\\

\noindent\textbf{Model Fitting}\\

All model fitting was achieved through utilizing Python 3.9. The modified Gompertz equation (3) was fitted to 284 unique ID 
using the non-linear least squares regression. I used the Levenbergâ€“Marquardt algorithm of minimization, which is the default 
algorithm for Python $lmfit$ function.  The Levenberg-Marquardt algorithm is an effective 
hybrid technique in solving non-linear equations. It uses both Gauss-Newton and steepest descent approaches to converge 
to a minimized, optimal solution \cite{wilson_chapter_2013}. For each unique ID, the four starting values ($N_{0}$, $N_{max}$, $r_{max}$, $t_{lag}$)
were estimated by these methods: $N_{0}$ was calculated by isolating the last value (the starting minimum value) within the sample size of 
the population measure. $N_{max}$ was calculated by finding the maximum value within the population measure. $r_{max}$ and $t_{lag}$
was calculated by sampling values within a normal distribution ($N$ = 100, $\mu$ = $r_{max}$ or $t_{lag}$, $\sigma$ = 0.1), then fitted  
to find the best minimized parameters. Out of 284 ID, I was unable to find a suitable minimized starting values for 10 unique datasets
(ID 4,14,16,20,88,280,281,282,283,284), therefore was omitted from further data processing. This resulted in 274 unique datasets remaining. 
For datasets with a sample size of less than the numbers of free parameter in equation (3) ($df$ = 0), an output of $NaN$ was given due to 
inadequate sample size for data analysis. Similarly, the cubic (1) and quadratic (2) equations was fitted to the remaining dataset 
using the default least squares regression (Levenbergâ€“Marquardt algorithm). All datasets were successfully fitted given the 
estimated starting values of 1. However, unique datasets with the sample size of less than 4 and 3 ($df$ = 0) respectively was given an output of $NaN$.\\ 

\noindent\textbf{Model Selection and Comparison}\\

Model selection was established using a selection criterion: AIC, or rather $AIC_{c}$ \cite{burnham_multimodel_2004}. AIC is a numerical value by which to 
rank competition models in term of information loss. It is used in comparison with other AIC values, where the lowest 
represents the best approximating model \cite{symonds_brief_2011}. In my study, instead of AIC, $AIC_{c}$ was used. When \(\frac{n}{K}<40\) where $n$ = sample size,
$K$ = total number of parameters in the most complex model, $AIC_{c}$ is recommended. $AIC_{c}$ is the small 
sample (second-order bias correction) version of AIC. By using AIC on data with small sample sizes, it increases the change 
of overfitting \cite{burnham_multimodel_2004}.\\

Recent versions of statistical software packages provide AIC values when generating model fitting. AIC values was extracted 
from the cubic, quadratic, Gomepertz model during model fitting. To calculate $AIC_{c}$: \\

    \begin{equation}    
    AIC = -2(ln(likelihood))+2K(\frac{n}{n-K-1})
    \end{equation}\\

    \begin{equation}    
    AIC_{c}= AIC(\frac{n}{n-K-1})
    \end{equation}\\

\noindent where $n$ is the sample size, $K$ is the number of free parameters in the model.\\

AIC scores are often shown as $\triangle$AIC. The individual AIC and $AIC_{c}$ values are not interpretable on its own as they have scaling 
issues and are affected by different sample sizes. Therefore, $AIC_{c}$ was rescaled by this equation: \\

    \begin{equation}    
    \triangle_{i}= AICc_{i} - AICc_{min}
    \end{equation}\\

\noindent where $AICc_{min}$ is the smallest $AIC_{c}$ value between candidate models. $\triangle_{i}$ is the information loss experienced if we were 
using the fitted model $i$. This transformation will result in the best fitted model to have $\triangle_{i}$ = 0. The larger the $\triangle_{i}$, the less 
plausible the fitted model is an accurate candidate model for the given dataset \cite{burnham_multimodel_2004}. In addition, Akaike Weight ($w_{i}$) was calculated as 
the probability that the model chosen is the best model given the data and the set of candidate models \cite{wagenmakers_aic_2004}.\\

The equation is given below:\\

    \begin{equation}    
    w_{i}= \frac{exp(-\triangle_{i}/2)}{\sum_{r=1}^{R}exp(-\triangle_{r}/2)}
    \end{equation}\\

\noindent where $\sum_{r=1}^{R}exp(-\triangle_{r}/2)$ is the sum of the value across all models. \\ 

Using R studios, I then compiled a summary table of all the calculated AIC values for each of the unique 274 datasets. 
However during the process of $AIC_{c}$ calculations, I eliminated two datasets (ID 200,212) for having a sample size 
less than the number of free parameters in the quadratic equation ($N<$3), which is too small for any meaningful analysis. 
In addition for 10 data sets, $-Inf$ and $Inf$ was outputted. From a closer look, it was due to $n$ being divided by a total value 
of 0 or less. Along with any datasets with only one successfully calculated AIC model ($N<$4), a total of 18 unique data 
sets was eliminated from my final table which demonstrates the best fitted model for each ID. \\

\noindent\textbf{Computing Languages and Tools}\\

Data Wrangling, model fitting, graphing and AIC calculations was performed in Python 3.9. AIC tables was created in R 4.1.2 
using R Studio. Sample graph (figure x) was created in R 4.1.2. Specific packages used within each computing languages can 
be found in README.md.

\section{Results}

\noindent\emph{(1,2)Fitting phenomenological and mechanistic mathematical models}\\

Out of the 284 unique IDs from the original dataset, I managed to successfully fit 255 IDs with both phenomenological and mechanistic
models. All datasets that were successfully fitted had a sample size of N>=5. All curves were plotted with the residuals and 
overlaid with the original dataset points as observed in supplementary data x.\\

\noindent\emph{(3)Model comparison using Akaike Information Criteria}\\
    \begin{table}[htb]
        \caption{The total number of each best fitted models across all 255 unique datasets ranked in order from highest to lowest. The cubic mathemataical equation was
        choosen as the best fitted model for the highest number of IDs. This ranking was based on comparisons of $AIC_{c}$ scores}
        \centering 
        \begin{tabular}{ | m{3cm} | m{12em} | }
            \hline
            Model & Total Number of Each Best Fitted Model Across All ID Based on $AIC_{c}$ Scores \\
            \hline
            Cubic & 168 \\ 
            \hline
            Gompertz & 82 \\
            \hline
            Quadratic & 5 \\
            \hline
            Total & 255 \\
            \hline
        \end{tabular}
    \label{table:1}
    \end{table} \\ 

Table x in supplmentry data demonstrates the best fitted model from each ID identified by the lowest $AIC_{c}$ score. Table \ref{table:1} further ranks
the three mathematical models by how many times a given model fits best across all unique datasets. From my study, the phenomenological cubic 
model fits best for the highest amount of ID bacterial datasets. 65\% of the ID are best fitted with a Cubic model, 32\% fitted with the 
Gompertz model, while only 3\% of the ID is best described with the quadratic model (ID 58,70,214,217,239). \\

    \begin{table}[htb]
        \caption{Total number of pairs between best fitted model and model with $AIC_{c}<$2 across all ID}
        \centering 
        \begin{tabular}{ | m{6em} | m{8em} | m{8em} |  }
            \hline
            Best Fitted Model & Models with $AIC_{c}$ values with $<$2 & Total Number of IDs \\
            \hline
            Cubic & Quadratic & 1 \\ 
            \hline
            Cubic & Gompertz & 3 \\
            \hline
            Quadratic & Cubic & 4 \\
            \hline
            Gompertz & Cubic & 7 \\
            \hline
            \multicolumn{2}{|c|}{Total} & 15 \\
            \hline
        \end{tabular}
    \label{table:2}
    \end{table} \\ 

Comparing the $\triangle$AICc of candidate models between each dataset ID, it was observed that some of the differences between the scores were $<$2. Highlighted
by Burnham and Anderson 2002, when a variable with poor explanatory power is added to a model, an output 
of $\triangle$AICc$<$2 can occur \cite{burnham_basic_2002,arnold_uninformative_2010}. Only when the differences are $>$2 is considered significant \cite{wyss_seismicity_2012}. In table \ref{table:2}, I can see that 15 IDs demonstrated âˆ†AICc values
that are not significantly different. Full list of unique IDs with insignificant, low AICc values can be found in supplementary table x. Within those 15
unique IDs, 7 of those indicated that Gompertz model was the best model fitted with the given data, however they were insignificantly different in comparison
to the cubic model. 4 out of the 5 best fitted quadratic model was not significantly different from the cubic model. While the best fitted cubic mode of 3 and
1 IDs was not significantly different from the Gompertz and quadratic model, respectively.

\section{Discussion}\\

Microbial growth is an area extensively studied in food microbiology due to causing the most common food poising \cite{buchanan_when_1997,xiong_comparison_1999}. The use of mathematical models
in fitting and predicting experimental data can help describe the behaviour of microorganisms under different environmental conditions (e.g temperature, PH) \cite{zwietering_modeling_1990}.
In my study, I compared how well two different types of mathematical models: phenomenological and mechanistic theory fit across bacterial population
growth data. This was investigated by fitting the quadratic, cubic and Gomepertz equations to each unique ID datasets and calculating the $AIC_{c}$ values. 
The lower the $AIC_{c}$ value, the best model it is out of the candidate set. In contrast to my initial hypothesis, the phenomenological cubic model 
had the highest percentage of being chosen as the best approximate model. The Gompertz equation was ranked second.  

From visual inspection, more than 100 curves were fitted badly with the Gompertz equation as a horizontal line was produced. (SEE GRAPH) This could 
be mainly due to the quality of data provided for model fitting. Although highly used within the literature, the fit of the Gompertz function can be
greatly affected by quality of the data observations \cite{labuza_growth_1993}. For a good fit of the function, xxx and xxxx suggested that preferably 15 uniformly spread
data points are required through all growth phases \cite{labuza_growth_1993,salazar_primary_2021}. Xxxx tested out this hypothesis by undergoing random deletion of observations
for each growth curve and refitting the Gompertz equation after. They found that fitting curves to \emph{Clostridium botulinum} species required evenly spread data
during the lag, growth and stationary phases. If no counts were made during the growth phase, a sigmoid curve could not be fitted, and this was
observed in data with approximately 10 or less. In addition, if there was no observation in the lag or stationary phases, an unrealistic 
estimate would be produced \cite{murphy_development_1996}. All of my unique IDs had a small sample size, from $N$ = 4 being the smallest, to $N$ = 66 the largest. Even for IDs
(91,90,92,89) with the largest sample size ($N$=66,63,57,54), the Gompertz model did not fit properly. I suggest that this is due to the lack
of observations collected during the lag phase, which unlike ID 90 had, successfully deemed the Gompertz as the best fitted model ($AIC_{c}$ = -216.31). 

More than 20 of the graphs produced during visual inspection demonstrated a pattern of decline. (SEE GRAPH) This is predicted to be the death phase of 
bacterial species. My modified gompertz equation did not consider incorporating the death phase in explaining bacterial growth curves. As such, 
the model did not fitted the growth well. Additionally, Xxxxx and xxxx described that the Gompertz model would not always be compatible
with microbial growth as the model does not extend beyond the stationary phase \cite{gibson_predicting_1988,xiong_comparison_1999}. As such, other models are found to be preferred and more
robust when modelling microbial death kinetics \cite{xiong_comparison_1999}. In the context of batch fermentation where bacterial population demonstrates a death phase,
xxxx found that the phenomenological cubic model best predict the overall dynamics of the experimental data in comparison to other mechanistic
models (Gompertz, Barayani and VÃ¡zquez-Murado) based on the results for the $RSS$ (residual sums of squares) $R^{2}$ and AIC value \cite{salazar_primary_2021}.

It can be suggested that the Gompertz model was ranked second in my study due to the quality and type of data provided. As such, the phenological
mathematical models seemed to be a better fit for predicting bacterial species data. However, what if we consider the power of fit between
phenomenological models? From table \ref{table:2}, I can conclude that the result where IDs identifying the quadratic model as the best fit is insignificant.
Instead, both types of phenomenological model (cubic vs quadratic) was similar in their respective datasets ($AIC_{c}<$2). In polynomial equations, previous work has shown mixed 
results regarding model fitting. Xxx found that the cubic model was superior to lower order models (quadratic) in fitting bacterial population 
growth \cite{murphy_development_1996}. While others have shown that quadratic models yield more accurate estimates of growth rate and lag time in noisy data sets \cite{ng_mathematical_1997,gauch_prediction_1993,mcclure_predictive_1997}.
In some cases, the power of the equations to reflect the data was approximately the same \cite{gibson_predicting_1988}. This study is unable to demonstrate a 
detailed comparison between both types of phenomenological model due to limited statistical analysis in the $RSS$ and $R^{2}$ value. 
Nonetheless, this could be investigated in future works as the main goal of model fitting is to choose the best parsimonious model that in its 
simplest state, still correctly predicts experimental results \cite{gauch_prediction_1993,gibson_predicting_1988}. In my study, I did not take into consideration other statistical analysis
such as an $ANOVA$ of the AIC, $RSS$, $R^{2}$ to compare model fits. Consequently, the models predicted in my study might not be the best fit even 
though my starting values were successfully minimized. Future work is recommended in repeating this method with larger and evenly spread 
samples across all bacterial growth stages while including additional in-depth statistical test to achieve more robust conclusions.

The application of mathematical models to population growth data is a widely effective method to investigate how populations respond to 
biological interactions. My investigation highlights the importance of phenomenological equations in food microbiology that often focuses rather
on mechanistic theory models. This provides as a reminder for future studies to consider both types of models in the study of bacterial growth data.
When undergoing the process of model fitting, one should first consider the quality of the experimental data and the type of species under
investigation. Furthermore, a true validation of the model should come from the ability to correctly predict experimental results and can be 
confirmed through independent testing of its parameters \cite{peleg_microbial_2011}.


\bibliographystyle{apalike}
\nolinenumbers
\bibliography{miniproject}

\section{Supplementary Data}






\end{document}